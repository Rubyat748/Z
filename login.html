<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ZTA â€“ Login / Signup</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

<!-- Your Firebase Config File -->
<script src="firebase.js"></script>

<style>
/* ==== UIVERSE STYLE ==== */
.form-container {
  width: 330px;
  border-radius: 0.75rem;
  background-color: #111827;
  padding: 2rem;
  color: #f3f4f6;
  transition: 0.3s;
}
.title { text-align: center; font-size: 1.5rem; font-weight: 700; }
.form { margin-top: 1.5rem; }
.input-group { margin-top: 0.25rem; font-size: 0.875rem; }
.input-group label { display: block; color: #9ca3af; margin-bottom: 4px; }
.input-group input {
  width: 100%; border-radius: 0.375rem; border: 1px solid #374151;
  background-color: #111827; padding: 0.75rem 1rem; color: #fff;
}
.input-group input:focus { border-color: #a78bfa; }
.sign {
  width: 100%; background-color: #a78bfa; padding: 0.75rem;
  margin-top: 10px; text-align: center; color: #111827;
  border-radius: 0.375rem; font-weight: 600;
}
.social-icons { display: flex; justify-content: center; margin-top: 10px; }
.icon { padding: 0.75rem; border: none; background: transparent; }
.signup, .switch {
  text-align: center; font-size: 0.75rem; color: #9ca3af; margin-top: 15px;
}
.switch a { color: #fff; text-decoration: underline; }
.hidden { display: none; }
</style>
</head>

<body class="flex items-center justify-center min-h-screen bg-black">

<!-- LOGIN FORM -->
<div id="loginBox" class="form-container">
  <p class="title">Login</p>

  <form class="form">
    <div class="input-group">
      <label>Email</label>
      <input type="email" id="login-email">
    </div>

    <div class="input-group">
      <label>Password</label>
      <input type="password" id="login-password">
    </div>

    <button type="button" class="sign" onclick="loginUser()">Sign in</button>
  </form>

  <div class="social-icons">
    <button class="icon" onclick="googleLogin()">
      <img src="https://www.svgrepo.com/show/475656/google-color.svg" width="26">
    </button>
  </div>

  <p class="switch">
    Don't have an account?
    <a href="#" onclick="showSignup()">Sign up</a>
  </p>
</div>

<!-- SIGNUP FORM -->
<div id="signupBox" class="form-container hidden">

  <p class="title">Sign Up</p>

  <form class="form">
    <div class="input-group">
      <label>Username</label>
      <input type="text" id="signup-username">
    </div>

    <div class="input-group">
      <label>Email</label>
      <input type="email" id="signup-email">
    </div>

    <div class="input-group">
      <label>Password</label>
      <input type="password" id="signup-password">
    </div>

    <button type="button" class="sign" onclick="signupUser()">Create Account</button>
  </form>

  <div class="social-icons">
    <button class="icon" onclick="googleLogin()">
      <img src="https://www.svgrepo.com/show/475656/google-color.svg" width="26">
    </button>
  </div>

  <p class="switch">
    Already have an account?
    <a href="#" onclick="showLogin()">Login</a>
  </p>
</div>

<script>
// Switch Screens
function showSignup() {
  document.getElementById("loginBox").classList.add("hidden");
  document.getElementById("signupBox").classList.remove("hidden");
}
function showLogin() {
  document.getElementById("signupBox").classList.add("hidden");
  document.getElementById("loginBox").classList.remove("hidden");
}

// LOGIN USER
async function loginUser() {
  const email = document.getElementById("login-email").value;
  const password = document.getElementById("login-password").value;

  try {
    await firebase.auth().signInWithEmailAndPassword(email, password);
    window.location.href = "index.html";
  } catch (error) {
    alert("Login failed: " + error.message);
  }
}

// SIGNUP USER
async function signupUser() {
  const username = document.getElementById("signup-username").value;
  const email = document.getElementById("signup-email").value;
  const password = document.getElementById("signup-password").value;

  try {
    const userCred = await firebase.auth().createUserWithEmailAndPassword(email, password);

    await firebase.firestore().collection("users").doc(userCred.user.uid).set({
      username: username,
      email: email,
      createdAt: new Date()
    });

    alert("Signup successful!");
    window.location.href = "index.html";
  } catch (error) {
    alert("Signup error: " + error.message);
  }
}

// GOOGLE LOGIN
async function googleLogin() {
  const provider = new firebase.auth.GoogleAuthProvider();

  try {
    const result = await firebase.auth().signInWithPopup(provider);
    const user = result.user;

    await firebase.firestore().collection("users").doc(user.uid).set({
      username: user.displayName,
      email: user.email,
      photo: user.photoURL,
      createdAt: new Date()
    }, { merge: true });

    window.location.href = "index.html";
  } catch (error) {
    alert("Google login failed: " + error.message);
  }
}
</script>

</body>
</html>
