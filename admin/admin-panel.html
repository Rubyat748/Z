<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ZTA Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>

<style>
body {
    background: #000;
    color: #0f0;
    font-family: "Courier New", monospace;
}
.box {
    border: 2px solid #0f0;
    border-radius: 12px;
    background: #050505;
}
.btn {
    border: 1px solid #00ff88;
    padding: 6px 10px;
    border-radius: 6px;
    transition: 0.2s;
}
.btn:hover {
    background: #00ff88;
    color: black;
}
</style>
</head>

<body class="p-6">

<h1 class="text-3xl font-bold text-green-400 mb-6">ZTA ADMIN PANEL</h1>

<!-- USER LIST -->
<div class="box p-4">

    <h2 class="text-xl text-green-300 mb-3">ðŸ‘¤ User Management</h2>

    <!-- Search -->
    <input id="searchUser"
        class="w-full mb-4 bg-transparent border border-green-600 p-2 rounded text-green-300"
        placeholder="Search username / UID">

    <div id="userList" class="space-y-4"></div>

</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getDatabase, ref, onValue, update } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

const firebaseConfig = {
    apiKey: "YOUR_KEY",
    authDomain: "YOUR_DOMAIN",
    databaseURL: "YOUR_DB_URL",
    projectId: "YOUR_PROJECT",
    storageBucket: "YOUR_BUCKET",
    messagingSenderId: "SENDER",
    appId: "APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const userList = document.getElementById("userList");
const searchUser = document.getElementById("searchUser");

// FETCH ALL USERS LIVE
onValue(ref(db, "users"), (snapshot) => {
    const users = snapshot.val();
    displayUsers(users);
});

// DISPLAY USERS
function displayUsers(users) {
    userList.innerHTML = "";

    if (!users) {
        userList.innerHTML = "<p class='text-red-400'>No users found.</p>";
        return;
    }

    const search = searchUser.value.toLowerCase();

    Object.keys(users).forEach(uid => {
        const u = users[uid];

        if (
            (u.username && u.username.toLowerCase().includes(search)) ||
            uid.toLowerCase().includes(search)
        ) {

            const banned = u.banned === true ? "YES" : "NO";
            const color = banned === "YES" ? "text-red-400" : "text-green-400";

            userList.innerHTML += `
                <div class="box p-4">
                    <p><span class="text-green-500">UID:</span> ${uid}</p>
                    <p><span class="text-green-500">Username:</span> ${u.username || "N/A"}</p>
                    <p><span class="text-green-500">Email:</span> ${u.email || "N/A"}</p>

                    <p><span class="text-green-500">Banned:</span> 
                       <span class="${color}">${banned}</span>
                    </p>

                    <div class="mt-3 flex gap-3">
                        <button onclick="banUser('${uid}')" class="btn">BAN</button>
                        <button onclick="unbanUser('${uid}')" class="btn">UNBAN</button>
                    </div>
                </div>
            `;
        }
    });
}

// BAN USER
window.banUser = function(uid) {
    update(ref(db, "users/" + uid), { banned: true });
    alert("User banned: " + uid);
}

// UNBAN USER
window.unbanUser = function(uid) {
    update(ref(db, "users/" + uid), { banned: false });
    alert("User unbanned: " + uid);
}

// Live search
searchUser.addEventListener("input", () => {
    onValue(ref(db, "users"), (snapshot) => {
        displayUsers(snapshot.val());
    });
});
</script>

</body>
</html>
